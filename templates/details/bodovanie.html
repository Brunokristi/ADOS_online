{% extends "base.html" %}

{% block title %}ADOS - Bodovanie{% endblock %}

{% block content %}
    {% if session.get('nurse') %}
    
    <table class="table-vykony" id="pointsTable" style="padding-top: 30px;">
        <thead>
            <tr>
                <th style="width:110px; top: 48px;">Dátum</th>
                <th style="width:120px; top: 48px;">Rodné Číslo</th>
                <th style="width:200px; top: 48px;">Meno Pacienta</th>
                <th style="width:120px; top: 48px;">Diagnóza</th>
                <th style="width:90px; top: 48px;">Výkon</th>
                <th style="width:70px; top: 48px;">Počet</th>
                <th style="width:110px; top: 48px;">PZS Lekára</th>
                <th style="width:110px; top: 48px;">ZPR Lekára</th>
                <th style="width:130px; top: 48px;">Dátum Žiadanky</th>
                <th style="width:90px; top: 48px;">Akcia</th>
            </tr>
        </thead>
        <tbody>
            {% for p in points %}
            <tr data-id="{{ p.id }}">
                <td>{{ p.datum }}</td>
                <td class="mono">{{ p.rodne_cislo }}</td>
                <td>{{ p.meno }}</td>
                <td>{{ p.diagnoza }}</td>
                <td class="mono">{{ p.vykon }}</td>
                <td class="num">{{ p.pocet }}</td>
                <td>{{ p.pzs }}</td>
                <td>{{ p.zpr }}</td>
                <td>{{ p.datum_ziadanky }}</td>
                <td class="actions">
                    <button class="btn-del" title="Zmazať">Zmazať</button>
                    <span class="row-status" aria-live="polite"></span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="bottom-section">
        <div class="half-form-group" style="width: 600px;">
            <div class="form-group">
                <label for="invoice_number">Číslo faktúry</label>
                <input type="text" id="invoice_number" name="invoice_number" required>
            </div>

            <div class="form-group">
                <label for="character">Charakter dávky</label>
                <select name="character" id="character">
                    <option value="N">Nová dávka</option>
                    <option value="O">Opravná dávka</option>
                    <option value="A">Aditívna dávka</option>
                </select>
            </div>

            <div class="form-group">
                <label for="poistovna">Poisťovňa</label>
                <select name="poistovna" id="poistovna">
                    {% for poistovna in poistovne %}
                        <option value="{{ poistovna.kod }}">{{ poistovna.nazov }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label for="range">Obdobie</label>
                <input class="dates" type="text" id="range" placeholder="Vyberte dátumy" autocomplete="off">
                <input type="hidden" id="start_date">
                <input type="hidden" id="end_date">
            </div>

        </div>

        <div style="width: 600px;">
            <button type="button" class="btn" id="save-btn">Vytvoriť dávku pre poisťovňu</button>
        </div>
    </div>

    <a class="floating_button" href="{{ url_for('points.create_points') }}" target="_blank" role="menuitem" data-popup
        title="Bodovať pacienta">
        <i class="bi bi-plus"></i>
    </a>

    {% else %}
    <p>Nie je prihlásený žiadny používateľ.</p>
    {% endif %}

</body>
{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/details/vykony.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/details/bodovanie.css') }}">
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/transport/transport.js') }}"></script>
    <script src="{{ url_for('static', filename='js/details/bodovanie.js') }}"></script>
{% endblock %}